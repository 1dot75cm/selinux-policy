policy_module(wm, 1.2.5)

attribute wm_domain;

########################################
#
# Declarations
#

attribute wm_domain;

type wm_exec_t;
<<<<<<< HEAD
corecmd_executable_file(wm_exec_t)
=======

########################################
#
# Common wm domain local policy
#
>>>>>>> 662a00bca8f52af8056f41abd0fdec77ea835b2a

allow wm_domain self:fifo_file rw_fifo_file_perms;
allow wm_domain self:process getsched;
allow wm_domain self:shm create_shm_perms;
allow wm_domain self:unix_dgram_socket create_socket_perms;

<<<<<<< HEAD
dev_read_urand(wm_domain)

files_read_etc_files(wm_domain)
files_read_usr_files(wm_domain)

fs_getattr_tmpfs(wm_domain)

application_signull(wm_domain)

miscfiles_read_fonts(wm_domain)

optional_policy(`
	dbus_system_bus_client(wm_domain)
	dbus_session_bus_client(wm_domain)
')

optional_policy(`
	pulseaudio_stream_connect(wm_domain)
')

optional_policy(`
	xserver_manage_core_devices(wm_domain)
')


=======
kernel_read_system_state(wm_domain)

dev_read_urand(wm_domain)

files_read_usr_files(wm_domain)

miscfiles_read_fonts(wm_domain)
miscfiles_read_localization(wm_domain)

userdom_manage_user_tmp_sockets(wm_domain)
userdom_tmp_filetrans_user_tmp(wm_domain, sock_file)

userdom_manage_user_home_content_dirs(wm_domain)
userdom_manage_user_home_content_files(wm_domain)
userdom_user_home_dir_filetrans_user_home_content(wm_domain, { dir file })
>>>>>>> 662a00bca8f52af8056f41abd0fdec77ea835b2a
