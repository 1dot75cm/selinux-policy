policy_module(tuned, 1.1.0)

########################################
#
# Declarations
#

type tuned_t;
type tuned_exec_t;
init_daemon_domain(tuned_t, tuned_exec_t)

type tuned_initrc_exec_t;
init_script_file(tuned_initrc_exec_t)

<<<<<<< HEAD
type tuned_etc_t;
files_config_file(tuned_etc_t)

type tuned_rw_etc_t;
files_config_file(tuned_rw_etc_t)

=======
>>>>>>> 9f8a6a356b99a19e09256fc37630cd6c22da66b4
type tuned_log_t;
logging_log_file(tuned_log_t)

type tuned_var_run_t;
files_pid_file(tuned_var_run_t)

########################################
#
# tuned local policy
#

<<<<<<< HEAD
allow tuned_t self:process signal;

dontaudit tuned_t self:capability { dac_override sys_tty_config };
allow tuned_t self:fifo_file rw_fifo_file_perms;
allow tuned_t self:udp_socket create_socket_perms;

read_files_pattern(tuned_t, tuned_etc_t, tuned_etc_t)

manage_files_pattern(tuned_t, tuned_etc_t, tuned_rw_etc_t)

manage_dirs_pattern(tuned_t, tuned_log_t, tuned_log_t)
manage_files_pattern(tuned_t, tuned_log_t, tuned_log_t)
logging_log_filetrans(tuned_t, tuned_log_t, file, "tuned.log")

manage_files_pattern(tuned_t, tuned_var_run_t, tuned_var_run_t)
manage_dirs_pattern(tuned_t, tuned_var_run_t, tuned_var_run_t)
files_pid_filetrans(tuned_t, tuned_var_run_t, { dir file })
=======
dontaudit tuned_t self:capability { dac_override sys_tty_config };

manage_dirs_pattern(tuned_t, tuned_log_t, tuned_log_t)
manage_files_pattern(tuned_t, tuned_log_t, tuned_log_t)
logging_log_filetrans(tuned_t, tuned_log_t, file)

manage_files_pattern(tuned_t, tuned_var_run_t, tuned_var_run_t)
files_pid_filetrans(tuned_t, tuned_var_run_t, file)
>>>>>>> 9f8a6a356b99a19e09256fc37630cd6c22da66b4

corecmd_exec_shell(tuned_t)
corecmd_exec_bin(tuned_t)

kernel_read_system_state(tuned_t)
kernel_read_network_state(tuned_t)
<<<<<<< HEAD
kernel_rw_kernel_sysctls(tuned_t)
kernel_rw_hotplug_sysctls(tuned_t)
kernel_rw_vm_sysctls(tuned_t)

dev_getattr_all_blk_files(tuned_t)
dev_getattr_all_chr_files(tuned_t)
dev_dontaudit_getattr_all(tuned_t)
dev_read_urand(tuned_t)
dev_rw_sysfs(tuned_t)
=======

dev_read_urand(tuned_t)
dev_read_sysfs(tuned_t)
>>>>>>> 9f8a6a356b99a19e09256fc37630cd6c22da66b4
# to allow cpu tuning
dev_rw_netcontrol(tuned_t)

files_read_etc_files(tuned_t)
files_read_usr_files(tuned_t)
files_dontaudit_search_home(tuned_t)

<<<<<<< HEAD
fs_getattr_xattr_fs(tuned_t)

auth_use_nsswitch(tuned_t)

=======
>>>>>>> 9f8a6a356b99a19e09256fc37630cd6c22da66b4
logging_send_syslog_msg(tuned_t)

miscfiles_read_localization(tuned_t)

userdom_dontaudit_search_user_home_dirs(tuned_t)

# to allow disk tuning
optional_policy(`
	fstools_domtrans(tuned_t)
')

<<<<<<< HEAD
optional_policy(`
	gnome_dontaudit_search_config(tuned_t)
')

optional_policy(`
	mount_domtrans(tuned_t)
')

=======
>>>>>>> 9f8a6a356b99a19e09256fc37630cd6c22da66b4
# to allow network interface tuning
optional_policy(`
	sysnet_domtrans_ifconfig(tuned_t)
')
