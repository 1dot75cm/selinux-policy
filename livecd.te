<<<<<<< HEAD
policy_module(livecd, 1.0.1)
=======
policy_module(livecd, 1.2.0)
>>>>>>> 9f8a6a356b99a19e09256fc37630cd6c22da66b4

########################################
#
# Declarations
#

<<<<<<< HEAD
type livecd_t;
type livecd_exec_t;
application_domain(livecd_t, livecd_exec_t)
role system_r types livecd_t;
=======
attribute_role livecd_roles;
roleattribute system_r livecd_roles;

type livecd_t;
type livecd_exec_t;
application_domain(livecd_t, livecd_exec_t)
role livecd_roles types livecd_t;
>>>>>>> 9f8a6a356b99a19e09256fc37630cd6c22da66b4

type livecd_tmp_t;
files_tmp_file(livecd_tmp_t)

########################################
#
# livecd local policy
#

dontaudit livecd_t self:capability2 mac_admin;

<<<<<<< HEAD
domain_interactive_fd(livecd_t)
=======
domain_ptrace_all_domains(livecd_t)
>>>>>>> 9f8a6a356b99a19e09256fc37630cd6c22da66b4

manage_dirs_pattern(livecd_t, livecd_tmp_t, livecd_tmp_t)
manage_files_pattern(livecd_t, livecd_tmp_t, livecd_tmp_t)
files_tmp_filetrans(livecd_t, livecd_tmp_t, { dir file })

<<<<<<< HEAD
dev_filetrans_all_named_dev(livecd_t)
storage_filetrans_all_named_dev(livecd_t)
term_filetrans_all_named_dev(livecd_t)

sysnet_filetrans_named_content(livecd_t)

optional_policy(`
	ssh_filetrans_admin_home_content(livecd_t)
')

optional_policy(`
	unconfined_domain_noaudit(livecd_t)
=======
optional_policy(`
	mount_run(livecd_t, livecd_roles)
>>>>>>> 9f8a6a356b99a19e09256fc37630cd6c22da66b4
')

optional_policy(`
	hal_dbus_chat(livecd_t)
')

optional_policy(`
<<<<<<< HEAD
	# Allow SELinux aware applications to request rpm_script execution
	rpm_transition_script(livecd_t)
	rpm_domtrans(livecd_t)
')
=======
	unconfined_domain(livecd_t)
')

>>>>>>> 9f8a6a356b99a19e09256fc37630cd6c22da66b4
