policy_module(gnomeclock, 1.0.5)

########################################
#
# Declarations
#

attribute_role gnomeclock_roles;

type gnomeclock_t;
type gnomeclock_exec_t;
<<<<<<< HEAD
init_daemon_domain(gnomeclock_t, gnomeclock_exec_t)
=======
init_system_domain(gnomeclock_t, gnomeclock_exec_t)
role gnomeclock_roles types gnomeclock_t;
>>>>>>> 662a00bca8f52af8056f41abd0fdec77ea835b2a

########################################
#
# Local policy
#

<<<<<<< HEAD
allow gnomeclock_t self:capability { sys_nice sys_time dac_override };
allow gnomeclock_t self:process { getattr getsched signal };
allow gnomeclock_t self:fifo_file rw_fifo_file_perms;
allow gnomeclock_t self:unix_stream_socket create_stream_socket_perms;
allow gnomeclock_t self:unix_dgram_socket create_socket_perms;
=======
allow gnomeclock_t self:capability { sys_nice sys_time };
allow gnomeclock_t self:process { getattr getsched signal };
allow gnomeclock_t self:fifo_file rw_fifo_file_perms;
allow gnomeclock_t self:unix_stream_socket { accept listen };
>>>>>>> 662a00bca8f52af8056f41abd0fdec77ea835b2a

kernel_read_system_state(gnomeclock_t)

corecmd_exec_bin(gnomeclock_t)
corecmd_exec_shell(gnomeclock_t)
<<<<<<< HEAD
corecmd_dontaudit_access_check_bin(gnomeclock_t)

corenet_tcp_connect_time_port(gnomeclock_t)

dev_rw_realtime_clock(gnomeclock_t)
dev_read_urand(gnomeclock_t)
dev_write_kmsg(gnomeclock_t)
dev_read_sysfs(gnomeclock_t)

files_read_etc_runtime_files(gnomeclock_t)
=======

corenet_all_recvfrom_unlabeled(gnomeclock_t)
corenet_all_recvfrom_netlabel(gnomeclock_t)
corenet_tcp_sendrecv_generic_if(gnomeclock_t)
corenet_tcp_sendrecv_generic_node(gnomeclock_t)

# tcp:37 (time)
corenet_sendrecv_inetd_child_client_packets(gnomeclock_t)
corenet_tcp_connect_inetd_child_port(gnomeclock_t)
corenet_tcp_sendrecv_inetd_child_port(gnomeclock_t)

dev_read_sysfs(gnomeclock_t)
dev_read_urand(gnomeclock_t)
dev_rw_realtime_clock(gnomeclock_t)

>>>>>>> 662a00bca8f52af8056f41abd0fdec77ea835b2a
files_read_usr_files(gnomeclock_t)

fs_getattr_xattr_fs(gnomeclock_t)

auth_use_nsswitch(gnomeclock_t)

<<<<<<< HEAD
init_dbus_chat(gnomeclock_t)

logging_stream_connect_syslog(gnomeclock_t)
logging_send_syslog_msg(gnomeclock_t)

miscfiles_manage_localization(gnomeclock_t)
=======
logging_send_syslog_msg(gnomeclock_t)

>>>>>>> 662a00bca8f52af8056f41abd0fdec77ea835b2a
miscfiles_etc_filetrans_localization(gnomeclock_t)
miscfiles_manage_localization(gnomeclock_t)
miscfiles_read_localization(gnomeclock_t)

userdom_read_all_users_state(gnomeclock_t)

optional_policy(`
<<<<<<< HEAD
	chronyd_systemctl(gnomeclock_t)
')

optional_policy(`
	clock_read_adjtime(gnomeclock_t)
=======
	chronyd_initrc_domtrans(gnomeclock_t)
')

optional_policy(`
>>>>>>> 662a00bca8f52af8056f41abd0fdec77ea835b2a
	clock_domtrans(gnomeclock_t)
')

optional_policy(`
<<<<<<< HEAD
	consolekit_dbus_chat(gnomeclock_t)
')

optional_policy(`
    consoletype_exec(gnomeclock_t)
')

optional_policy(`
dbus_system_domain(gnomeclock_t, gnomeclock_exec_t)
')

optional_policy(`
	gnome_manage_usr_config(gnomeclock_t)
	gnome_manage_home_config(gnomeclock_t)
')

optional_policy(`
	ntp_domtrans_ntpdate(gnomeclock_t)
	ntp_initrc_domtrans(gnomeclock_t)
	init_dontaudit_getattr_all_script_files(gnomeclock_t)
	init_dontaudit_getattr_exec(gnomeclock_t)
	ntp_systemctl(gnomeclock_t)
')

optional_policy(`
	policykit_dbus_chat(gnomeclock_t)
=======
	dbus_system_domain(gnomeclock_t, gnomeclock_exec_t)

	optional_policy(`
		consolekit_dbus_chat(gnomeclock_t)
	')

	optional_policy(`
		policykit_dbus_chat(gnomeclock_t)
	')
')

optional_policy(`
	ntp_domtrans_ntpdate(gnomeclock_t)
	ntp_initrc_domtrans(gnomeclock_t)
')

optional_policy(`
>>>>>>> 662a00bca8f52af8056f41abd0fdec77ea835b2a
	policykit_domtrans_auth(gnomeclock_t)
	policykit_read_lib(gnomeclock_t)
	policykit_read_reload(gnomeclock_t)
')
