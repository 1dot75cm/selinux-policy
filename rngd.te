<<<<<<< HEAD
policy_module(rngd, 1.0.0)
=======
policy_module(rngd, 1.0.2)
>>>>>>> 662a00bca8f52af8056f41abd0fdec77ea835b2a

########################################
#
# Declarations
#

type rngd_t;
type rngd_exec_t;
init_daemon_domain(rngd_t, rngd_exec_t)

type rngd_initrc_exec_t;
init_script_file(rngd_initrc_exec_t)

<<<<<<< HEAD
type rngd_unit_file_t;
systemd_unit_file(rngd_unit_file_t)

=======
>>>>>>> 662a00bca8f52af8056f41abd0fdec77ea835b2a
########################################
#
# Local policy
#

allow rngd_t self:capability sys_admin;
<<<<<<< HEAD
allow rngd_t self:process { signal };
allow rngd_t self:fifo_file rw_fifo_file_perms;
allow rngd_t self:unix_stream_socket create_stream_socket_perms;
=======
allow rngd_t self:process signal;
allow rngd_t self:fifo_file rw_fifo_file_perms;
allow rngd_t self:unix_stream_socket { accept listen };
>>>>>>> 662a00bca8f52af8056f41abd0fdec77ea835b2a

kernel_rw_kernel_sysctl(rngd_t)

dev_read_rand(rngd_t)
dev_read_urand(rngd_t)
dev_rw_tpm(rngd_t)
dev_write_rand(rngd_t)

files_read_etc_files(rngd_t)

logging_send_syslog_msg(rngd_t)
<<<<<<< HEAD
=======

miscfiles_read_localization(rngd_t)
>>>>>>> 662a00bca8f52af8056f41abd0fdec77ea835b2a
